<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Model Deployment (Alpha) ¬∑ PrimeHub</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Allow users to deploy a model as a service."/><meta name="docsearch:version" content="3.6"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Model Deployment (Alpha) ¬∑ PrimeHub"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.primehub.io/"/><meta property="og:description" content="Allow users to deploy a model as a service."/><meta property="og:image" content="https://docs.primehub.io/img/primehub_icon.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://docs.primehub.io/img/primehub_icon.svg"/><link rel="shortcut icon" href="/img/PrimeHub_icon_32.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/railscasts.min.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-123266454-3"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'UA-123266454-3');
            </script><link rel="stylesheet" href="/css/code-block-buttons.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald|Lato:400,400i,700"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/PrimeHub_icon_64.png" alt="PrimeHub"/><h2 class="headerTitleWithLogo">PrimeHub</h2></a><a href="/versions"><h3>3.6</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/3.6/introduction" target="_self">Documentation</a></li><li class=""><a href="/docs/3.6/index-zh" target="_self">ÁπÅ‰∏≠Êñá‰ª∂</a></li><li class=""><a href="https://one.primehub.io/" target="_blank">üåü 1-Click Install ‚áó</a></li><li class=""><a href="https://cse.google.com/cse?cx=a1b608e4a3908f544" target="_blank">Search ‚áó</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>‚Ä∫</i><span>Designs</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Overview<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/concept">Concept</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/nb-data-store">Persistence</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/resources-quota">Resources Quota</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/roles">Permission</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/environment-variables">Environment Variables</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/login-portal-user">User Portal</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Installation<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/dev-introduction">Overview</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Setup Kubernetes</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/kubernetes_on_gke">Kubernetes on GKE</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/kubernetes_on_eks">Kubernetes on AWS EKS</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Setup PrimeHub Community</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/install_primehub_ce">Install PrimeHub CE</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/kubernetes_on_ubuntu_ce">Install PrimeHub CE on Single Node</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Setup PrimeHub Enterprise</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/install_primehub">Install PrimeHub EE</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/kubernetes_on_ubuntu_machine">Install PrimeHub EE on Single Node</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Upgrade</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/upgrade-ce2ee">From CE to EE</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">QuickStart<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/qs-primehub">PrimeHub CE/EE</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/qs-primehub-deploy">PrimeHub Deploy</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Notebooks<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/launch-project">Start Notebook</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/user-advanced-setting">Advanced Settings</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/ssh-config">SSH Server Feature</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/notebook-tips">Tips</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Notebook Extension</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/ph-notebook-extension">PrimeHub Extension</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/notebook-as-job">Notebook as a Job</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Jobs<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/job-submission-feature">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/job-artifact-feature">Job Artifacts</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Tutorial</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/job-submission-tutorial-simple">Simple Example</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/job-submission-tutorial-p1">(Part1) MNIST classifier training</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/job-submission-tutorial-p2">(Part2) MNIST classifier training</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/job-submission-tutorial-p3">(Advanced) Use Job Submission to Tune Hyperparameters</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/job-submission-tutorial-p4">(Advanced) Model Serving by Seldon</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/job-artifacts-simple">Job Artifacts Simple Usecase</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Schedule<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/job-scheduling-feature">Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Models<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/model-management">Overview (Beta)</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-configuration">Configuration</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Tutorial</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/model-management-tutorial">Manage and Deploy a Model</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Deployments<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-feature">Overview</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Tutorials</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-tutorial-concepts">Concepts</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-tutorial-prepackaged-image">Deploy a Model by Pre-packaged Server</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-tutorial-prepackaged-image-phfs">Deploy a Model by Pre-packaged Server (PHFS)</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-tutorial-model-image">Deploy a Model by Image built from Language Wrapper</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Pre-packaged servers</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-prepackaged-server-intro">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-prepackaged-server-tensorflow2">TensorFlow server</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-prepackaged-server-pytorch">PyTorch server</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-prepackaged-server-sklearn">SKLearn server</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-prepackaged-server-custom">Customize Pre-packaged Server</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-prepackaged-server-test">Run Pre-packaged Server Locally</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Package from Language Wrapper</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-language-wrapper-intro">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-language-wrapper-python">Package a Model Image for Python</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-language-wrapper-r">Package a Model Image for R</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-language-wrapper-reusable-base-image">Package a Model Image from a Reusable Base Image</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Advanced</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-prediction-apis">Prediction APIs</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model-deployment-model-uri">Model URI</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Shared Files<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/shared-files">Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Apps<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/primehub-app">Overview (Beta)</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Tutorials</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/primehub-app-tutorial-template">Create Your Own App</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/primehub-app-tutorial-mlflow">Create an MLflow server</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/primehub-app-tutorial-label-studio">Label Dataset by Label Studio</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Builtin Apps</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/primehub-app-builtin-code-server">Code Server</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/primehub-app-builtin-label-studio">Label Studio</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/primehub-app-builtin-matlab">MATLAB</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/primehub-app-builtin-mlflow">MLflow</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/primehub-app-builtin-streamlit">Streamlit</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Group Administration<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/group-image">Images</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/group-setting">Settings</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Admin Portal<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/login-portal-admin">Overview</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Manage users and groups</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-user">User Management</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-group">Group Management</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Manage Instance Type</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-instancetype">Instance Type Management</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/usecase-toleration">Toleration</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/usecase-nodeselector">NodeSelector</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-it-performance">Quality of Service for Pods</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Manage and build images</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-image">Image Management</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-build-image">Image Builder</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/custom-image-guideline">Custom Image Guideline</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/images-list">Available Images List</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Manage Datasets and Upload</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-dataset">Dataset Management</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-uploader">Upload Server</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Manage and obtain secrets</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-secret">Secret Management</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Manage Notebook instances</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-nb-admin">Notebooks Admin</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Monthly Report</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-report">Usage Reports</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">System</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/admin-system">System Settings</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Maintenance tool kits</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/maintenance">Maintenance Notebook</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/maintenance-resize-user-vol">Increase User Volume</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/maintenance-resize-group-vol">Increase Group Volume</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble/howto-check-user-vol">HOWTO - Check User Volume Usage</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble/howto-check-group-vol">HOWTO - Check Group Volume Usage</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Quick Start</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/create-user">Create User</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/create-group">Create Group</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/assign-group-admin">Assign Group Admin</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/add-instance-type">Create/Plan Instance Type</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/add-infuseai-image">Add InfuseAI Image</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/add-image">Add Image</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/build-image">Build Image</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/secret-pull-image">Pull Secret for GitLab</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/quickstart/secret-gitsync">Gitsync Secret for GitHub</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">PrimeHub Deploy<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/deploy-index">Overview</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Admin Portal</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/model_deployment/md-admin-portal">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model_deployment/md-group">Group Management</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model_deployment/md-user">User Management</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model_deployment/md-instancetype">Instance Type Management</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model_deployment/md-secret">Secret Management</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/model_deployment/md-system">System Management</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Designs and Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/design/architecture">Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/data-model">Data Model</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/crds">CRDs</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/graphql">GraphQL</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/persistence-storage">Persistence Storages</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Designs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/design/admission">Admission</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/jupyterhub">JupyterHub</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/notebook-kernel-process">Notebook with kernel process</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/dataset-upload">Dataset Upload</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/image-builder">Image Builder</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/job-submission">Job Submission</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/job-scheduler">Job Scheduler</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/job-monitoring">Job Monitoring</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/install-helper-design">Install Helper</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/user-portal">User Portal</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/meta-chart">Primehub Meta Chart</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/3.6/design/model-deployment">Model Deployment (Alpha)</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/primehub-store">PrimeHub Store</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/log-persistence">Log Persistence</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/phfs">PrimeHub File System (PHFS)</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/usage">PrimeHub Usage</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/job-artifact">Job Artifact</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/design/primehub-apps">PrimeHub Apps</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Configuration<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/configure-primehub-store">PrimeHub Store</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/configure-ssh-server">SSH Server</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/configure-job-submission">Job Submission</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/configure-model-deployment">Model Deployment</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/configure-image-builder">Image Builder</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/getting_started/configure-self-signed-ca">Self-Signed Certificate</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Tasks<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Jupyter Images</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/repo2docker">repo2docker image</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/non-standard-image">Non standard image</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/matlab-img">MATLAB Image</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/spyder-image">Spyder Image</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/rstudio-image">RStudio Image</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/ros-image">ROS Image</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/api-token">Generate API Token</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Monitoring</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/monitoring">Grafana PrimeHub Dashboard</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">MLflow</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/mlflow-compare">Compare MLflow Models</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/3.6/tasks/customize-job-runtime">Customize Runtime</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">References<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/references/primehub_chart">Chart Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/comparison">Tiers Feature Comparison</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/ssh-vscode">VSCode Remote-SSH Notebook</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/guide_manual/ssh-keygen">SSH Key Generation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Trouble Shooting<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble-shoot-guide">Trouble-shooting Guide</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">JupyterHub</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble/jh-blank-page">After spawned, JupyterHub shows a blank page</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble/dataset-failure">Jupyter spawning fails due to mounting datasets</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Keycloak</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble/kc-brute-force-detection">Lock down accounts after several login failures</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble/kc-password-policy">Password Policy</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">SSH Server</h4><ul><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble/ssh-server-permission-denied">Permission Denied</a></li><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble/ssh-server-connection-refused">Connection Refused</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/3.6/trouble/kubelet-restart">Restart Kubelet</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Model Deployment (Alpha)</h1></header><article><div><span><p>Allow users to deploy a model as a service.</p>
<h2><a class="anchor" aria-hidden="true" id="features"></a><a href="#features" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Features</h2>
<ol>
<li><strong>Multiple ML framework support:</strong> Supports Tensorflow 1, Tensorflow 2, Keras, Pytorch, XGBoost, MXNet, Scikit-learn, LightGBM</li>
<li><strong>Multiple language support:</strong> Supports Python, Java, R, NodeJS, Go (Please see the Seldon wrapper in the Seldon wrapper document)</li>
<li><strong>Horizontal scaleout:</strong> The deployed model service can be scaled to multiple replicas of the model service. So that it can achieve load balancing and fault tolerance easily.</li>
<li><strong>Deployment history:</strong> Track the deployment history.</li>
<li><strong>Resource constraint:</strong> The usage of resources for model deployment is constrained by group resource quota.</li>
<li><strong>Ingress:</strong> Create the ingress resource to redirect external requests to internal model service.</li>
<li><strong>Endpoint Type:</strong> Supports public or private endpoints. For private endpoint, multiple users(clients) is supported.</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="user-journey"></a><a href="#user-journey" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>User Journey</h2>
<p>Build and deploy a model image</p>
<ul>
<li>Train a model for some ML framework and select the best model for deployment</li>
<li>Wrap the model server code and model file and build the image by <code>s2i</code></li>
<li>Test the packaged image locally</li>
<li>Push the image to docker registry</li>
<li>In primehub, create a model deployment</li>
<li>Select the instance type, model image, and the number of replicas</li>
<li>Wait until the deployment is ready</li>
<li>Use <code>curl</code> to test against the model deployment endpoint</li>
</ul>
<p>Build and deploy a model by a pre-packaged model server (since v3.2.0)</p>
<ul>
<li>Train a model for tensorflow2 and put the model somewhere in PHFS</li>
<li>In primehub, create a model deployment</li>
<li>Set the <strong>tensorflow2 pre-packaged image</strong> as the model image and set the model URI accordingly</li>
<li>Wait until the deployment is ready</li>
<li>Use <code>curl</code> to test against the model deployment endpoint</li>
</ul>
<p>Build and deploy a model by a custom pre-packaged model server (since v3.2.0)</p>
<ul>
<li>Train a model for some ML framework and put the model somewhere in PHFS</li>
<li>Wrap the model code and build the image by <code>s2i</code></li>
<li>Test the custom pre-packaged image along with a model file locally</li>
<li>Push the image to docker registry</li>
<li>In primehub, create a model deployment</li>
<li>Set the <strong>custom pre-packaged image</strong> as the model image, set the model URI accordingly</li>
<li>Wait until the deployment is ready</li>
<li>Use <code>curl</code> to test against the model deployment endpoint</li>
</ul>
<p>Update a deployment</p>
<ul>
<li>Select a deployment</li>
<li>Click the Update button</li>
<li>Change the model image and/or model URI</li>
<li>Click <strong>Confirm and deploy</strong> to deploy</li>
</ul>
<h1><a class="anchor" aria-hidden="true" id="design"></a><a href="#design" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Design</h1>
<h2><a class="anchor" aria-hidden="true" id="seldon"></a><a href="#seldon" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Seldon</h2>
<p><a href="https://www.seldon.io/">Seldon</a> is a model deployment solution in the community. The reason why we select Seldon as the solution is because it provides a common way to package different framework's by different programming languages into a docker image.</p>
<p>Seldon also provides an operator under <code>Seldon core</code> project to manage a <code>SeldonDeployment</code> resource and reconcile it to the underlying deployments and services. However, for simplicity, we decide not to use the <code>SeldonDeployment</code> resource. Instead, we define PhDeployment and the controller for generating/to generate the underlying <strong>Deployment</strong> and <strong>Service</strong> directly. In addition, we also create an <strong>Ingress</strong> for model serving endpoint.</p>
<h2><a class="anchor" aria-hidden="true" id="custom-resource"></a><a href="#custom-resource" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom Resource</h2>
<p>A <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom resource</a> <code>PhDeployment</code> is defined for PrimeHub-defined model deployment. The deployment is very similar to the Kubernetes native deployment, the controller would spawn a deployment according to the <code>PhDeployment</code>'s spec. The difference is that the spec contains the PrimeHub-specific concept, like User, Group, and InstanceType.</p>
<p>Here is an example of <code>PhDeployment</code>.</p>
<pre><code class="hljs"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">primehub.io/v1alpha1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">PhDeployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">spam-classifier-abcxy</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">hub</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">displayName:</span> <span class="hljs-string">"spam classifier"</span>
  <span class="hljs-attr">userId:</span> <span class="hljs-string">"4d203a08-896a-4aa8-86e2-882f4d4aadec"</span>
  <span class="hljs-attr">userName:</span> <span class="hljs-string">"phadmin"</span>
  <span class="hljs-attr">groupId:</span> <span class="hljs-string">"ca6b032e-b8be-44d2-9646-092622d6ba15"</span>
  <span class="hljs-attr">groupName:</span> <span class="hljs-string">"phusers"</span>
  <span class="hljs-attr">stop:</span> <span class="hljs-literal">false</span>
  <span class="hljs-attr">description:</span> <span class="hljs-string">|
    This is my first deployment.
    This is my first deployment.
    This is my first deployment.
</span>  <span class="hljs-attr">endpoint:</span>
    <span class="hljs-attr">accessType:</span> <span class="hljs-string">private</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">foo</span>
      <span class="hljs-attr">token:</span> <span class="hljs-string">$apr1$sZ55Hcwn$NSHL3Y.HiBBTLQCIIEbUm.</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">bar</span>
      <span class="hljs-attr">token:</span> <span class="hljs-string">$apr1$bJ3Ar/uT$BM2iFc6RObu7ZdYffToIQ.</span>
  <span class="hljs-attr">predictors:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">predictor1</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">2</span>
      <span class="hljs-attr">modelImage:</span> <span class="hljs-string">sandhya1594/spam-classifier:1.0.0.1</span>
      <span class="hljs-attr">instanceType:</span> <span class="hljs-string">cpu-only</span>
      <span class="hljs-attr">metadata:</span>
        <span class="hljs-attr">LEARNING_RATE:</span> <span class="hljs-string">"0.02"</span>
        <span class="hljs-attr">MINI_BATCH:</span> <span class="hljs-string">"20"</span>
        <span class="hljs-attr">ACCURACY:</span> <span class="hljs-string">"0.98"</span>
<span class="hljs-attr">status:</span>
  <span class="hljs-attr">phase:</span> <span class="hljs-string">deploying</span>
  <span class="hljs-attr">message:</span> <span class="hljs-string">"Deploying"</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">2</span>
  <span class="hljs-attr">availableReplicas:</span> <span class="hljs-number">2</span>
  <span class="hljs-attr">endpoint:</span> <span class="hljs-string">https://primehub.local/deployment/user-defined-postfix/predict</span>
  <span class="hljs-attr">history:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">time:</span> <span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-string">-23T02:03:15Z</span>
      <span class="hljs-attr">spec:</span> <span class="hljs-string">&lt;PhDeploymentSpec&gt;</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">time:</span> <span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-string">-22T23:45:23Z</span>
      <span class="hljs-attr">spec:</span> <span class="hljs-string">&lt;PhDeploymentSpec&gt;</span>
</code></pre>
<p>The <code>PhDeployment</code> resource has the following children</p>
<ul>
<li><strong>Ingress:</strong> The ingress resource to route the traffic to a given model deployment</li>
<li><strong>Service:</strong> The service resource of a given deployment</li>
<li><strong>Deployment:</strong> The deployment of the user's image.</li>
<li><strong>Secret:</strong> The secret for <code>HTTP basic authentication</code> of a given private endpoint access type deployment</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="model-image"></a><a href="#model-image" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Model Image</h2>
<p>For each deployment, it requires to provide the model image. It is responsible to translate the REST request to the internal model prediction call.</p>
<p>In <a href="https://docs.seldon.io/projects/seldon-core/en/latest/index.html">Seldon documentation</a>, there are three ways to prepare the model image</p>
<ol>
<li><p><a href="https://docs.seldon.io/projects/seldon-core/en/latest/servers/overview.html">Pre-Packaged Inference Servers</a>: Users can use the pre-packaged model image and provide the model URI for the latest model files.</p>
<ul>
<li>MLflow Server</li>
<li>SKLearn server</li>
<li>Tensorflow Serving (Not supported in PrimeHub)</li>
<li>XGBoost server</li>
</ul></li>
<li><p><a href="https://docs.seldon.io/projects/seldon-core/en/latest/wrappers/language_wrappers.html">Language Wrappers for Custom Model</a>: Users build the model file by different language wrapper. It provides the best flexibility and loading time.</p>
<ul>
<li>Python Language Wrapper (Production)</li>
<li>Java Language Wrapper (Incubating)</li>
<li>R Language Wrapper (ALPHA)</li>
<li>NodeJS Language Wrapper (ALPHA)</li>
<li>Go Language Wrapper (ALPHA)</li>
</ul></li>
<li><p><a href="https://docs.seldon.io/projects/seldon-core/en/latest/servers/custom.html">Custom Pre-packaged Inference Servers</a>. Like the pre-packaged server, but users can package their reusable pre-packaged server. And deploy by the model URI for the latest model files.</p></li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="model-uri"></a><a href="#model-uri" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Model URI</h2>
<p>There are two ways to load model files in the model inference server.</p>
<ol>
<li>Pack the model files in the model image</li>
<li>Load the model at runtime</li>
</ol>
<p>If we select the second method, the model image should support to load <code>model_uri</code> from the wrapper class. For the detail, you can see the <a href="https://docs.seldon.io/projects/seldon-core/en/latest/servers/custom.html">custom inference server</a> in the Seldon document. Or reference the <a href="https://github.com/SeldonIO/seldon-core/tree/master/servers">Seldon</a> and <a href="https://github.com/InfuseAI/primehub-seldon-servers">PrimeHub</a> pre-packaged servers implementation.</p>
<p>For the implementation, the model URI loading process is described as follows.</p>
<ol>
<li>In the phdeployment spec, there is the <code>modelURI</code> specified.</li>
<li>When the controller creates the underlying pods, it will create the model container along with a model download init-container.</li>
<li>The init-container uses the image <code>gcr.io/kfserving/storage-initializer</code> to load the model files. It uses the <a href="https://github.com/kubeflow/kfserving/blob/master/python/kfserving/kfserving/storage.py">KFServing storage API</a> to download files from <code>modelURI</code> to <code>/mnt/models</code></li>
<li>The model container shares the same <em>empytDir</em> volume and mounted at <code>/mnt/models</code> as well. The model wrapper class would read the model path from <a href="https://docs.seldon.io/projects/seldon-core/en/latest/servers/custom.html">wrapper class constructor</a> and invokes the framework-specific model loading API to load the model.</li>
</ol>
<p>Currently, the model URI supports</p>
<ol>
<li><strong>PHFS</strong>: Example, <code>phfs:///file/to/my/model</code> (will map to <code>/phfs/file/to/my/model</code>)</li>
<li><strong>GCS public bucket</strong>: Example, <code>gs://seldon-models/sklearn/iris</code></li>
</ol>
<p>We don't support S3, GCS, Azure blob private buckets for now. And we don't support http/https either.</p>
<h2><a class="anchor" aria-hidden="true" id="api-endpoint"></a><a href="#api-endpoint" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API Endpoint</h2>
<p>According to Seldon <a href="https://docs.seldon.io/projects/seldon-core/en/latest/reference/apis/external-prediction.html">external prediction</a> and <a href="https://docs.seldon.io/projects/seldon-core/en/latest/reference/apis/internal-api.html">internal microservice</a> API, the endpoint of prediction is</p>
<pre><code class="hljs"><span class="hljs-params">&lt;prefix&gt;</span><span class="hljs-meta-keyword">/api/</span>v0<span class="hljs-number">.1</span>/predictions
<span class="hljs-meta"># or</span>
<span class="hljs-params">&lt;prefix&gt;</span><span class="hljs-meta-keyword">/api/</span>v1<span class="hljs-number">.0</span>/predictions
</code></pre>
<p>For a primehub model deployment, the prefix would be</p>
<pre><code class="hljs"><span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/&lt;primehub-domain&gt;/deployment</span><span class="hljs-regexp">/&lt;deployment-name&gt;/api</span><span class="hljs-regexp">/v1.0/predictions</span>
</code></pre>
<p>And the input and output of the prediction endpoint are <em>tensor</em> or <em>ndarray</em>.</p>
<p>You can also send unstructured data (e.g. image file), please find more examples in our <a href="https://github.com/InfuseAI/model-deployment-examples">model deployment examples</a></p>
<h2><a class="anchor" aria-hidden="true" id="endpoint-type"></a><a href="#endpoint-type" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Endpoint Type</h2>
<p>We provide two endpoint types: <code>public</code> and <code>private</code>. If a deployment is set to <code>public</code>, anyone who can connect to the domain(URL) has the privilege to use the model through the API endpoint.</p>
<p>If a deployment is set to <code>private</code>, the user must provide the correct <code>HTTP basic authentication</code> information when sending the request to the API endpoint. Otherwise, the deployment will return the <code>401 Unauthorized</code> error. The <code>HTTP basic authentication</code> user name and password(token) can be configured under the UI. We also support multiple user names/passwords configurations.</p>
<p>The underlying technical process when setting the <code>HTTP basic authentication</code> under the UI is:</p>
<ol>
<li>Data scientist adds a user client in UI</li>
<li>GraphQL generates a random password(token) in <code>md5</code> format and it will only show one time in UI</li>
<li>GraphQL also update <code>phdeployment</code> CRD endpoint information in the spec</li>
<li>Primehub-controller update the <code>phdeployment</code> <code>ingress</code> and <code>secret</code> settings for <code>HTTP basic authentication</code> configurations</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="deployment-phases"></a><a href="#deployment-phases" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deployment Phases</h2>
<p>There are 5 phases in the <code>PhDeployment</code></p>
<ul>
<li><strong>Deploying:</strong> Model is deploying. When a deployment is created, updated, or started, it will go to this phase immediately.</li>
<li><strong>Deployed:</strong> Model is deployed successfully. All replicas are in the available state.</li>
<li><strong>Stopping:</strong> The deployment is stopping. When a deployment is stopped, it will go to this phase immediately.</li>
<li><strong>Stopped:</strong> The deployment is stopped successfully.</li>
<li><strong>Failed:</strong> The model deployment is failed.</li>
</ul>
<p>There are several reasons for the <code>Failed</code> phase. They include</p>
<ul>
<li>Group, or instance type not found</li>
<li>Image invalid or cannot be pulled successfully</li>
<li>Group resource not enough</li>
<li>Cluster resource not enough</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="resource-constraint"></a><a href="#resource-constraint" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resource Constraint</h2>
<p>A model deployment consumes only the group quota.</p>
<p>The pod of the model deployment has the label <code>primehub.io/group=escape(&lt;group&gt;)</code>. The PrimeHub's validating webhook would invalidate the pod creation if the new pod exceeds the group resource.</p>
<p>Once the resource exceeds, the deployment would change to phase <code>Failed</code> with the &quot;group resource not enough&quot; error message.</p>
<h2><a class="anchor" aria-hidden="true" id="replicas-log"></a><a href="#replicas-log" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Replicas Log</h2>
<p>The pod of the model deployment has the labels</p>
<ul>
<li><code>app=primehub-group</code></li>
<li><code>primehub.io/phdeployment=&lt;deployment-id&gt;</code></li>
</ul>
<p>The GraphQL server would list the pod by these labels and show the log for the container name <code>model</code></p>
<h2><a class="anchor" aria-hidden="true" id="deployment-history"></a><a href="#deployment-history" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deployment History</h2>
<p>Whenever the <code>.spec</code> changes, there appends a new record under <code>.status.history</code>. It contains <code>time</code> for update time and <code>spec</code> for the snapshot of the current new updated <code>.spec</code>.</p>
<p>The history array only keeps the latest 32 records.</p>
<h2><a class="anchor" aria-hidden="true" id="monitoring"></a><a href="#monitoring" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Monitoring</h2>
<p>We use <a href="https://github.com/SeldonIO/seldon-core/tree/master/engine">Seldon engine</a> to export Prometheus metrics. Under the hood, it accepts the prediction request and forwards it to the user wrapped model container. At the same time, it keeps track of the count and time for each request. The metrics details are described in <a href="https://docs.seldon.io/projects/seldon-core/en/latest/analytics/analytics.html">Seldon metrics</a></p>
<p>Seldon has a project name <a href="https://github.com/SeldonIO/seldon-core/tree/master/helm-charts/seldon-core-analytics">Seldon analytics</a>. In which, it installs the Prometheus and Grafana. However, our preferred Prometheus/Grafana installation is <a href="https://github.com/coreos/prometheus-operator">prometheus-operator</a>. To adapt the metrics to Prometheus-operator, we implement our own <a href="https://github.com/coreos/prometheus-operator#customresourcedefinitions">PodMonitoring</a> and Grafana dashboard to visualize the collected metrics.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/3.6/design/meta-chart"><span class="arrow-prev">‚Üê </span><span>Meta Chart</span></a><a class="docs-next button" href="/docs/3.6/design/primehub-store"><span class="function-name-prevnext">PrimeHub Store</span><span class="arrow-next"> ‚Üí</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#features">Features</a></li><li><a href="#user-journey">User Journey</a></li><li><a href="#seldon">Seldon</a></li><li><a href="#custom-resource">Custom Resource</a></li><li><a href="#model-image">Model Image</a></li><li><a href="#model-uri">Model URI</a></li><li><a href="#api-endpoint">API Endpoint</a></li><li><a href="#endpoint-type">Endpoint Type</a></li><li><a href="#deployment-phases">Deployment Phases</a></li><li><a href="#resource-constraint">Resource Constraint</a></li><li><a href="#replicas-log">Replicas Log</a></li><li><a href="#deployment-history">Deployment History</a></li><li><a href="#monitoring">Monitoring</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/PrimeHub_icon_128.png" alt="PrimeHub" width="66" height="58"/></a><div><h5></h5><a href="https://discord.gg/CrAxQznedH">Discord</a><a href="https://github.com/infuseai">GitHub</a><a href="https://medium.com/infuseai">Medium</a><a href="https://www.facebook.com/InfuseAI">Facebook</a><a href="https://www.katacoda.com/infuseai">Katacoda</a></div><div><h5>More</h5><a href="https://infuseai.io">About InfuseAI</a><a href="/docs/comparison">Community | Enterprise | Deploy</a><a href="https://docs.google.com/forms/d/e/1FAIpQLSe_Z8JfIbYnvhOampGN_XXle4d3GVX04E8evnNI_Py3abth-A/viewform">Request Trial</a></div></section><section class="copyright">Copyright ¬© 2022 InfuseAI</section></footer></div></body></html>