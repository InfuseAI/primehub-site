<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>[Use Case] NodeSelector · PrimeHub</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="When it comes to DevOps, we may arrange downtime of nodes for regular maintenance several times a year, however, for the sake of impact reduction of our service, we keep some of nodes continue to be available for providing the service, and shutdown other nodes in shift. In this case, initially we label all of nodes with `service=on`"/><meta name="docsearch:version" content="2.2.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="[Use Case] NodeSelector · PrimeHub"/><meta property="og:type" content="website"/><meta property="og:url" content="https://InfuseAI.github.io/primehub-site/"/><meta property="og:description" content="When it comes to DevOps, we may arrange downtime of nodes for regular maintenance several times a year, however, for the sake of impact reduction of our service, we keep some of nodes continue to be available for providing the service, and shutdown other nodes in shift. In this case, initially we label all of nodes with `service=on`"/><meta property="og:image" content="https://InfuseAI.github.io/primehub-site/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://InfuseAI.github.io/primehub-site/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/primehub-site/img/PrimeHub_icon_32.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/primehub-site/js/scrollSpy.js"></script><link rel="stylesheet" href="/primehub-site/css/main.css"/><script src="/primehub-site/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/primehub-site/"><img class="logo" src="/primehub-site/img/PrimeHub_icon_64.png" alt="PrimeHub"/><h2 class="headerTitleWithLogo">PrimeHub</h2></a><a href="/primehub-site/versions"><h3>2.2.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/primehub-site/docs/getting-started-admin" target="_self">For Admin</a></li><li class=""><a href="/primehub-site/docs/getting-started-user" target="_self">For User</a></li><li class=""><a href="/primehub-site/docs/dev-introduction" target="_self">For Developers</a></li><li class=""><a target="_self"></a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Admin Dashboard</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Admin Dashboard<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/primehub-site/docs/guide_manual/admin-system">System Management</a></li><li class="navListItem"><a class="navItem" href="/primehub-site/docs/guide_manual/admin-user">User Management</a></li><li class="navListItem"><a class="navItem" href="/primehub-site/docs/guide_manual/admin-group">Group Management</a></li><li class="navListItem"><a class="navItem" href="/primehub-site/docs/guide_manual/admin-instancetype">Instance Type Management</a></li><li class="navListItem"><a class="navItem" href="/primehub-site/docs/guide_manual/admin-image">Image Management</a></li><li class="navListItem"><a class="navItem" href="/primehub-site/docs/guide_manual/admin-build-image">Build Images</a></li><li class="navListItem"><a class="navItem" href="/primehub-site/docs/guide_manual/admin-dataset">Dataset Management</a></li><li class="navListItem"><a class="navItem" href="/primehub-site/docs/guide_manual/admin-secret">Secret Management</a></li><li class="navListItem"><a class="navItem" href="/primehub-site/docs/guide_manual/usecase-toleration">[Use Case] Toleration</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/primehub-site/docs/guide_manual/usecase-nodeselector">[Use Case] NodeSelector</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">[Use Case] NodeSelector</h1></header><article><div><span><p>When it comes to DevOps, we may arrange downtime of nodes for regular maintenance several times a year, however, for the sake of impact reduction of our service, we keep some of nodes continue to be available for providing the service, and shutdown other nodes in shift. In this case, initially we label all of nodes with <code>service=on</code></p>
<pre><code class="hljs">kubectl label nodes node1 service=<span class="hljs-keyword">on</span>
</code></pre>
<p>and apply a nodeSelector on every instance types when creation by NodeSelector on Admin UI so that they, initially, are able to to be scheduled on any nodes labelled with <code>service=on</code>.</p>
<p><img src="/primehub-site/docs/assets/nodeSelector_add.png" alt=""></p>
<p><img src="/primehub-site/docs/assets/nodeSelector_use_case_on.png" alt=""></p>
<p>When a maintenance comes, we label some of nodes with service=off</p>
<pre><code class="hljs">kubectl <span class="hljs-keyword">label</span><span class="bash"> nodes node5 service=off</span>
</code></pre>
<p>afterwards newly spawned projects are scheduled only on nodes with label <code>service=on</code> according to the nodeSelector. We can do maintenance on these nodes with <code>service=off</code> when no running pods.</p>
<p><img src="/primehub-site/docs/assets/nodeSelector_use_case_off.png" alt=""></p>
<p>Then we bring these nodes of out-off-service back to service with the label <code>service=on</code>.</p>
<pre><code class="hljs">kubectl label nodes node5 service=<span class="hljs-keyword">on</span>
</code></pre>
<p>Repeatedly, we make some nodes <code>service=off/service=on</code> in shift until whole maintenance is completed.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/primehub-site/docs/guide_manual/usecase-toleration"><span class="arrow-prev">← </span><span>[Use Case] Toleration</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/primehub-site/" class="nav-home"><img src="/primehub-site/img/PrimeHub_icon_128.png" alt="PrimeHub" width="66" height="58"/></a><div><h5>Docs</h5><a href="/primehub-site/docs/setup_deploy/installation.html">Setup &amp; Deployment</a><a href="/primehub-site/docs/tips/kibana-dashboard.html">Tips &amp; More</a></div><div><h5>Community</h5><a href="https://github.com/InfuseAI/primehub">PrimeHub CE</a></div><div><h5>More</h5><a href="/primehub-site/blog">Blog</a><a href="https://infuseai.io">About InfuseAI</a></div></section><section class="copyright">Copyright © 2019 InfuseAI</section></footer></div></body></html>